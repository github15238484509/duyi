!function(s,o){function t(t){this.dom=t,this.data=null,this.imgTimer=null,this.constructorIndex=null,this.listConstructor=null}t.prototype={init(){this.getDom(),this.getData("../mock/data.json")},getData(t){s.ajax({url:t,methods:"get",success:t=>{this.data=t,this.constructorIndex=new o.constructorIndex(t.length),this.progess=new o.progess.Progess(o.music.audio),this.loadMusic(this.constructorIndex.index),o.music.end(()=>{this.loadMusic(this.constructorIndex.next())}),this.controlMusic(),this.renderListEvent(t,this.dom)}})},getDom(){this.record=document.querySelector(".songImg img"),this.controlBtns=document.querySelectorAll(".control li"),this.name=document.querySelector(".name"),this.singer=document.querySelector(".singer"),this.album=document.querySelector(".album")},loadMusic(t){o.render(this.data[t],this),o.music.load(this.data[t].audioSrc),this.progess.init(this.data[t].duration),"play"===o.music.status&&(this.controlBtns[2].className="playing",o.music.play())},controlMusic(){var s=this;this.controlBtns[1].addEventListener("touchend",()=>{o.music.status="play",this.loadMusic(this.constructorIndex.prev())}),this.controlBtns[2].addEventListener("touchend",function(){var t="pause"==o.music.status?"play":"pause";this.className="pause"==o.music.status?"playing":"",o.music[t](),"play"==t?(s.imgRotate(s.record.rotate||0),s.progess.move()):(s.imgStopRotate(),s.progess.stop())}),this.controlBtns[3].addEventListener("touchend",()=>{o.music.status="play",this.loadMusic(this.constructorIndex.next()),this.imgRotate(0),s.progess.stop(),s.progess.move()}),this.controlBtns[4].addEventListener("touchend",()=>{this.listConstructor.show(this.constructorIndex.index)})},imgRotate(t){clearInterval(this.imgTimer),this.imgTimer=setInterval(()=>{t+=.2,this.record.style.transform=`rotate(${t}deg)`,this.record.rotate=t},1e3/60)},imgStopRotate(){clearInterval(this.imgTimer)},renderListEvent(t,s){this.listConstructor=new o.listConstructor(t,s),this.listConstructor.init(),this.listConstructor.dllist.forEach((t,s)=>{t.addEventListener("touchend",()=>{s!==this.constructorIndex.index&&(this.constructorIndex.index=s,o.music.status="play",this.loadMusic(s),this.listConstructor.show(s))})}),this.listConstructor.close.addEventListener("touchend",()=>{this.listConstructor.show(this.constructorIndex.index)})}};const e=new t(document.querySelector("#wrap"));e.init(),console.log(e)}(window.Zepto,window.player);